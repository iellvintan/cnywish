<!DOCTYPE html>
<html>

<head>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.20.1/dist/phaser.js"></script>
</head>

<body>

    <script>
    // Get window width & height
    var x = window.innerWidth;
    var y = window.innerHeight;
    var config = {
        type: Phaser.AUTO,
        width: x,
        height: y,
        backgroundColor: '#aa381e',
        parent: 'phaser-example',
        physics: {
            default: 'matter',
            matter: {
                enableSleeping: true
            }
        },
        scene: {
            preload: preload,
            create: create
        }
    };

    var c = 0;
    var h;
    var timedEvent;

    var game = new Phaser.Game(config);

    function preload() {
        this.load.image('coin', 'assets/images/coin.png');
        this.load.image('greet', 'assets/images/greet.png');
    }

    function create() {
        this.matter.world.setBounds(0, 0, x, y, 128, true, true, false, true);
        timedEvent = this.time.addEvent({ delay: 100, callback: onEvent, callbackScope: this, loop: true });
    }

    function onEvent() {
        var ball = this.matter.add.image(Phaser.Math.Between(0, x), Phaser.Math.Between(-600, 0), 'coin');
        ball.setCircle();
        ball.setFriction(0.005);
        // ball.setBounce(1);

        c++;

        // 125 coins
        if (c === 125) {
            timedEvent.remove(false);
            this.matter.world.setBounds(0, 0, x, y, 0, false, false, false, false);
            this.time.addEvent({ delay: 2500, callback: onEvent2, callbackScope: this });
        }
    }

    function onEvent2() {
        img = this.matter.add.image(x / 2, -600, 'greet');
        h = img.height;
        this.time.addEvent({ delay: 1500, callback: onEvent3, callbackScope: this });
    }

    function onEvent3() {
        this.matter.world.setBounds(0, (y + h)/2, x, 0, 128, true, true, false, true);
    }
    </script>

</body>

</html>

